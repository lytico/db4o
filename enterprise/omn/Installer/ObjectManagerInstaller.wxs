<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<Product Id="1bf13897-000f-412a-b728-45cbd9ac0dcf" Name="db4o Object Manager @db4o.version.dotted@" Language="1033" Version="1.0.0.0" Manufacturer="Versant Corp." UpgradeCode="76df6a36-2074-4e79-bdc8-e7e588e31e13">
	  <Package Id="*" Keywords="Installer" Description="db4o Object Manager Enterprise @db4o.version.dotted@ Installer" Comments="db4o is a registered trademark of Versant Corp." Manufacturer="Versant Corp." InstallerVersion="200" Languages="1033" Compressed="yes" />

	  <Media Id="1" Cabinet="OMEInstaller.cab" EmbedCab="yes" />
		<Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="ProgramFilesFolder">
				<Directory Id="PFiles.Db4objects" Name="db4o">
					<Directory Id="INSTALLDIR" Name="db4o-@db4o.version.dotted@">			
						<Directory Id="INSTALLLOCATION" Name="Object Manager Enterprise">
							<Component Id="OMEComponent" Guid="b6ada86f-0fbb-4f76-939b-d0c0cd5a358d">
								<File Id="OMAddin.Addin.id" 
									  Name="OMAddin.Addin" 
									  Source="@dir.omn.output@\OMAddin.Addin" DiskId="1" Vital="yes" />
									  
								<File Id="Db4objects.Db4o.CS.id" 
									  Name="Db4objects.Db4o.CS.dll" 
									  Source="@dir.omn.output@\Db4objects.Db4o.CS.dll" DiskId="1" Vital="yes" />						
							  
								<File Id="Db4objects.Db4o.id" 
									  Name="Db4objects.Db4o.dll" 
									  Source="@dir.omn.output@\Db4objects.Db4o.dll" DiskId="1" Vital="yes" />					  
							  
								<File Id="Db4objects.Db4o.Linq.id" 
									  Name="Db4objects.Db4o.Linq.dll" 
									  Source="@dir.omn.output@\Db4objects.Db4o.Linq.dll" DiskId="1" Vital="yes" />
									  
								<File Id="Db4objects.Db4o.Optional.id" 
									  Name="Db4objects.Db4o.Optional.dll" 
									  Source="@dir.omn.output@\Db4objects.Db4o.Optional.dll" DiskId="1" Vital="yes" />
							  
								<File Id="OMPlus.id" 
									  Name="OMPlus.dll" 
									  Source="@dir.omn.output@\OMPlus.dll" DiskId="1" Vital="yes" />
									  
							   <File Id="OMAddinDataTransferLayer.id" 
									  Name="OMAddinDataTransferLayer.dll" 
									  Source="@dir.omn.output@\OMAddinDataTransferLayer.dll" DiskId="1" Vital="yes" />
							  
								<File Id="OMAddin.id" 
									  Name="OMAddin.dll" 
									  Source="@dir.omn.output@\OMAddin.dll" DiskId="1" Vital="yes" />
							  
								<File Id="OMControlLibrary.id" 
									  Name="OMControlLibrary.dll" 
									  Source="@dir.omn.output@\OMControlLibrary.dll" DiskId="1" Vital="yes" />					  
							  
								<File Id="OME.Crypto.id" 
									  Name="OME.Crypto.dll" 
									  Source="@dir.omn.output@\OME.Crypto.dll" DiskId="1" Vital="yes" />
							  
								<File Id="ExpandableGridView.id" 
									  Name="ExpandableGridView.dll" 
									  Source="@dir.omn.output@\ExpandableGridView.dll" DiskId="1" Vital="yes" />
							  
								<File Id="LoggingBlock.id" 
									  Name="LoggingBlock.dll" 
									  Source="@dir.omn.output@\LoggingBlock.dll" DiskId="1" Vital="yes" />
                
                <File Id="OMCustomConfigurationforUser.id"
									  Name="OMCustomConfigurationforUser.dll"
									  Source="@dir.omn.output@\OMCustomConfigurationforUser.dll" DiskId="1" Vital="yes" />
                
                <File Id="OMCustomConfigImplementation.id"
                  Name="OMCustomConfigImplementation.dll"
                  Source="@dir.omn.output@\OMCustomConfigImplementation.dll" DiskId="1" Vital="yes" />
               
                <File Id="Microsoft.Practices.EnterpriseLibrary.Common.id" 
									  Name="Microsoft.Practices.EnterpriseLibrary.Common.dll" 
									  Source="@dir.omn.output@\Microsoft.Practices.EnterpriseLibrary.Common.dll" DiskId="1" Vital="yes" />
							  
								<File Id="Microsoft.Practices.EnterpriseLibrary.Logging.id" 
									  Name="Microsoft.Practices.EnterpriseLibrary.Logging.dll" 
									  Source="@dir.omn.output@\Microsoft.Practices.EnterpriseLibrary.Logging.dll" DiskId="1" Vital="yes" />
							  
								<File Id="Microsoft.Practices.ObjectBuilder.id" 
									  Name="Microsoft.Practices.ObjectBuilder.dll" 
									  Source="@dir.omn.output@\Microsoft.Practices.ObjectBuilder.dll" 
									  DiskId="1" Vital="yes" />
							  
								<!-- Visual Studio Interop Assemblies  -->
								<File Id="EnvDTE.id"
									  Name="EnvDTE.dll"
									  Source="@dir.omn.output@\EnvDTE.dll"
									  DiskId="1" Vital="yes" />

								<File Id="EnvDTE80.id"
									  Name="EnvDTE80.dll"
									  Source="@dir.omn.output@\EnvDTE80.dll"
									  DiskId="1" Vital="yes" />

								<File Id="Microsoft.VisualStudio.CommandBars.id"
									  Name="Microsoft.VisualStudio.CommandBars.dll"
									  Source="@dir.omn.output@\Microsoft.VisualStudio.CommandBars.dll"
									  DiskId="1" Vital="yes" />

								<!-- Visual Studio Interop Assemblies -->
								
								<File Id="OMNPostInstaller.id" 
									  Name="OMNPostInstaller.exe" 
									  Source="@dir.omn.output@\OMNPostInstaller.exe" DiskId="1" Vital="yes" />						
									  
								<!-- VS windows configuration file -->
								<File Id="windows.prf.id"
									  Name="windows.prf"
									  Source="@dir.omn.installer.script@\windows.prf" 
									  DiskId="1" Vital="no" />
							
							</Component>
              <!-- FAQ Files for help -->
              <Directory Id="FAQLOCATION" Name="FAQ">
                <Component Id="FAQComponent" Guid="{F6CDA2C8-DC87-C321-A25D-44190A1C83EE}">
                  <File Id="FAQ.id" 
                        Name="FAQ.htm" 
                        KeyPath="yes" DiskId="1" 
                        Source="@dir.omn.faq@\FAQ.htm" />
                </Component>
                <Directory Id="FAQFILESLOCATION" Name="FAQ Files" >
                  <Component Id="FAQFileComponent" Guid="{4959E673-7137-A838-E506-BFF599503C88}">
                    <File Id="FAQXMLFILES.id" 
                          Name="filelist.xml"
                          Source="@dir.omn.faq@\FAQ_files\filelist.xml" 
                          DiskId="1" />                  
                    
                    <File Id="FAQIMAGE1" 
                          Name="image001.gif" 
                          DiskId="1" 
                          Source="@dir.omn.faq@\FAQ_files\image001.gif" />
                 
                    <File Id="FAQIMAGE2" 
                          Name="image002.gif" 
                          KeyPath="yes" 
                          DiskId="1" 
                          Source="@dir.omn.faq@\FAQ_files\image002.gif" />
                  </Component>
                </Directory>
              </Directory>
						</Directory>
					</Directory>
				</Directory>
			</Directory>
		</Directory>
    <!-- VS windows configuration file -->
		<Feature Id="OME" Title="db4o Object Manager" Level="1" ConfigurableDirectory='INSTALLLOCATION'>
			<ComponentRef Id="OMEComponent" />
      <ComponentRef Id="FAQComponent" />
      <ComponentRef Id="FAQFileComponent" />
		</Feature>
		
		<Condition Message="You need to be an administrator to install this product.">Privileged</Condition>
		
		<Property Id="VSINSTALLED">
			<RegistrySearch Id="CheckVSInstalled" Root="HKCR" Key="VisualStudio.DTE.@target.vs-serial.version@" Type="raw" />
		</Property>
		<Condition Message="Visual Studio @target.vs-year.version@ is required.">VSINSTALLED</Condition>
		
		<!--BUTTON TEXTS-->
		<Property Id="Button_Back">&lt; &amp;Back</Property>
		<Property Id="Button_Next">&amp;Next &gt;</Property>
		<Property Id="Button_Finish">&amp;Finish</Property>
		<Property Id="Button_OK">OK</Property>
		<Property Id="Button_Cancel">Cancel</Property>
		<Property Id="Button_Browse">Br&amp;owse...</Property>
		<Property Id="Button_Exit">&amp;Exit</Property>
		<Property Id="Button_Ignore">&amp;Ignore</Property>
		<Property Id="Button_Install">&amp;Install</Property>
		<Property Id="Button_Remove">&amp;Remove</Property>
		<Property Id="Button_Repair">&amp;Repair</Property>
		<Property Id="Button_Reset">&amp;Reset</Property>
		<Property Id="Button_Resume">&amp;Resume</Property>
		<Property Id="Button_Retry">&amp;Retry</Property>
		<Property Id="Button_Return">&amp;Return</Property>
		<Property Id="Button_Yes">&amp;Yes</Property>
		<Property Id="Button_No">&amp;No</Property>
		<!--END BUTTON TEXTS-->

		<Property Id="_BrowseProperty" Value="INSTALLLOCATION" />

		<!-- ICONS PROPERTIES -->
		<Property Id="InstallerIcon"><![CDATA[insticon]]></Property>
		<Property Id="CustomSetupIcon"><![CDATA[custicon]]></Property>
		<Property Id="CompleteSetupIcon"><![CDATA[completi]]></Property>
		<Property Id="RepairIcon"><![CDATA[repairic]]></Property>
		<Property Id="RemoveIcon"><![CDATA[removico]]></Property>

		<UI>
			<InstallUISequence>
				<FindRelatedProducts />
				<Show Dialog="ProgressDialog" After="WelcomeDialog" />
				<Show Dialog="UserExit" OnExit="cancel" />
				<Show Dialog="ExitDialog" OnExit="success" />
				<Show Dialog="FatalError" OnExit="error" />
				<Show Dialog="WelcomeDialog" After="MigrateFeatureStates"><![CDATA[NOT Installed]]></Show>
				<Show Dialog="MaintenanceWelcomeDialog" After="WelcomeDialog"><![CDATA[Installed AND NOT RESUME AND NOT Preselected]]></Show>
			</InstallUISequence>
		  
		  <!-- FONT DEFINITION -->
		  <Property Id="TitleFont">{&amp;DlgFontBold8}</Property>
		  <Property Id="BigFont">{&amp;VerdanaBold13}</Property>
		  <Property Id="DefaultUIFont">DlgFont8</Property>
		  <TextStyle Id="DlgFont8" FaceName="Tahoma" Size="8" />
		  <TextStyle Id="DlgFontBold8" FaceName="Tahoma" Size="8" Bold="yes" />
		  <TextStyle Id="VerdanaBold13" FaceName="Verdana" Size="13" Bold="yes" />
		  <TextStyle Id="TahomaBold10" FaceName="Tahoma" Size="8"  Bold="yes" />
		  <!-- END FONT DEFINITION -->
		  <UIText Id="AbsentPath" />
		  <UIText Id="bytes">bytes</UIText>
		  <UIText Id="GB">GB</UIText>
		  <UIText Id="KB">KB</UIText>
		  <UIText Id="MB">MB</UIText>
		  <UIText Id="MenuAbsent">Entire feature will be unavailable</UIText>
		  <UIText Id="MenuAdvertise">Feature will be installed when required</UIText>
		  <UIText Id="MenuAllCD">Entire feature will be installed to run from CD</UIText>
		  <UIText Id="MenuAllLocal">Entire feature will be installed on local hard drive</UIText>
		  <UIText Id="MenuAllNetwork">Entire feature will be installed to run from network</UIText>
		  <UIText Id="MenuCD">Will be installed to run from CD</UIText>
		  <UIText Id="MenuLocal">Will be installed on local hard drive</UIText>
		  <UIText Id="MenuNetwork">Will be installed to run from network</UIText>
		  <UIText Id="ScriptInProgress">Gathering required information...</UIText>
		  <UIText Id="SelAbsentAbsent">This feature will remain uninstalled</UIText>
		  <UIText Id="SelAbsentAdvertise">This feature will be set to be installed when required</UIText>
		  <UIText Id="SelAbsentCD">This feature will be installed to run from CD</UIText>
		  <UIText Id="SelAbsentLocal">This feature will be installed on the local hard drive</UIText>
		  <UIText Id="SelAbsentNetwork">This feature will be installed to run from the network</UIText>
		  <UIText Id="SelAdvertiseAbsent">This feature will become unavailable</UIText>
		  <UIText Id="SelAdvertiseAdvertise">Will be installed when required</UIText>
		  <UIText Id="SelAdvertiseCD">This feature will be available to run from CD</UIText>
		  <UIText Id="SelAdvertiseLocal">This feature will be installed on your local hard drive</UIText>
		  <UIText Id="SelAdvertiseNetwork">This feature will be available to run from the network</UIText>
		  <UIText Id="SelCDAbsent">This feature will be uninstalled completely, you won't be able to run it from CD</UIText>
		  <UIText Id="SelCDAdvertise">This feature will change from run from CD state to set to be installed when required</UIText>
		  <UIText Id="SelCDCD">This feature will remain to be run from CD</UIText>
		  <UIText Id="SelCDLocal">This feature will change from run from CD state to be installed on the local hard drive</UIText>
		  <UIText Id="SelChildCostNeg">This feature frees up [1] on your hard drive.</UIText>
		  <UIText Id="SelChildCostPos">This feature requires [1] on your hard drive.</UIText>
		  <UIText Id="SelCostPending">Compiling cost for this feature...</UIText>
		  <UIText Id="SelLocalAbsent">This feature will be completely removed</UIText>
		  <UIText Id="SelLocalAdvertise">This feature will be removed from your local hard drive, but will be set to be installed when required</UIText>
		  <UIText Id="SelLocalCD">This feature will be removed from your local hard drive, but will be still available to run from CD</UIText>
		  <UIText Id="SelLocalLocal">This feature will remain on you local hard drive</UIText>
		  <UIText Id="SelLocalNetwork">This feature will be removed from your local hard drive, but will be still available to run from the network</UIText>
		  <UIText Id="SelNetworkAbsent">This feature will be uninstalled completely, you won't be able to run it from the network</UIText>
		  <UIText Id="SelNetworkAdvertise">This feature will change from run from network state to set to be installed when required</UIText>
		  <UIText Id="SelNetworkLocal">This feature will change from run from network state to be installed on the local hard drive</UIText>
		  <UIText Id="SelNetworkNetwork">This feature will remain to be run from the network</UIText>
		  <UIText Id="SelParentCostNegNeg">This feature frees up [1] on your hard drive. It has [2] of [3] subfeatures selected. The subfeatures free up [4] on your hard drive.</UIText>
		  <UIText Id="SelParentCostNegPos">This feature frees up [1] on your hard drive. It has [2] of [3] subfeatures selected. The subfeatures require [4] on your hard drive.</UIText>
		  <UIText Id="SelParentCostPosNeg">This feature requires [1] on your hard drive. It has [2] of [3] subfeatures selected. The subfeatures free up [4] on your hard drive.</UIText>
		  <UIText Id="SelParentCostPosPos">This feature requires [1] on your hard drive. It has [2] of [3] subfeatures selected. The subfeatures require [4] on your hard drive.</UIText>
		  <UIText Id="TimeRemaining">Time remaining: {[1] minutes }{[2] seconds}</UIText>
		  <UIText Id="VolumeCostAvailable">Available</UIText>
		  <UIText Id="VolumeCostDifference">Difference</UIText>
		  <UIText Id="VolumeCostRequired">Required</UIText>
		  <UIText Id="VolumeCostSize">Disk Size</UIText>
		  <UIText Id="VolumeCostVolume">Volume</UIText>
		
		  <Dialog Id="WelcomeDialog" Width="370" Height="270" Title="[ProductName] [Setup]">
			<Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="[Button_Next]">
			  <Publish Event="NewDialog" Value="SetupTypeDlg">1</Publish>
			</Control>
			<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="[Button_Cancel]">
			  <Publish Event="SpawnDialog" Value="CancelDialog">1</Publish>
			</Control>
			<Control Id="Bitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="234" FixedSize="yes" TabSkip="no" Text="dialog.bmp" />
			<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Disabled="yes" Text="[Button_Back]" />
			<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="374" Height="0" />
			<Control Id="Description" Type="Text" X="135" Y="70" Width="220" Height="90" Transparent="yes" NoPrefix="yes">
			  <Text>The installer will guide you through the steps required to install [ProductName] on your computer.</Text>
			</Control>
			<Control Id="Title" Type="Text" X="135" Y="20" Width="220" Height="60" Transparent="yes" NoPrefix="yes">
			  <Text>[BigFont]Welcome to the [ProductName] installation</Text>
			</Control>
		  </Dialog>

		  <Dialog Id="MaintenanceWelcomeDialog" Width="370" Height="270" Title="[ProductName] [Setup]" NoMinimize="yes">
			<Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="374" Height="44" FixedSize="yes" TabSkip="no" Text="banner.bmp" />
			<Control Id="Bitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="234" FixedSize="yes" TabSkip="no" Text="dialog.bmp" />
			<Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="[Button_Next]">
			  <Publish Event="NewDialog" Value="MaintenanceTypeDialog"><![CDATA[1]]></Publish>
			</Control>
			<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="[Button_Cancel]">
			  <Publish Event="SpawnDialog" Value="CancelDialog"><![CDATA[1]]></Publish>
			</Control>
			<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Disabled="yes" Text="[Button_Back]" />
			<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="374" Height="0" />
			<Control Id="Description" Type="Text" X="135" Y="70" Width="220" Height="60" Transparent="yes" NoPrefix="yes">
			  <Text>The [Wizard] will allow you to change the way [ProductName] features are installed on your computer or even to remove [ProductName] from your computer.  Click Next to continue or Cancel to exit the [Wizard].</Text>
			</Control>
			<Control Id="Title" Type="Text" X="135" Y="20" Width="220" Height="60" Transparent="yes" NoPrefix="yes">
			  <Text>{\VerdanaBold13}Welcome to the [ProductName] [Wizard]</Text>
			</Control>
		  </Dialog>

		  <Dialog Id="SelectFolderDialog" Width="370" Height="270" Title="[ProductName]" TrackDiskSpace="yes">
			<Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="[Button_Next]">
			  <Publish Event="NewDialog" Value="VerifyReadyDialog">1</Publish>
			  <Publish Event="DoAction" Value="UpdateTargetDir">1</Publish>
			  <Publish Event="SetTargetPath" Value="TARGETDIR">1</Publish>
			</Control>
			<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="[Button_Cancel]">
			  <Publish Event="SpawnDialog" Value="CancelDialog">1</Publish>
			</Control>
			<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="[Button_Back]">
			  <Publish Event="NewDialog" Value="WelcomeDialog">1</Publish>
			</Control>
			<Control Id="FolderEdit" Type="PathEdit" X="18" Y="126" Width="252" Height="18" Property="INSTALLLOCATION" Sunken="yes">
			  <Condition Action="disable">Installed</Condition>
			</Control>
			<Control Id="Browse" Type="PushButton" X="276" Y="126" Width="90" Height="18" Text="[Button_Browse]">
			  <Condition Action="disable">Installed</Condition>
			  <Publish Property="_BrowseProperty" Value="INSTALLLOCATION">1</Publish>
			  <Publish Event="SpawnDialog" Value="BrowseDialog">1</Publish>
			</Control>
			<Control Id="Text" Type="Text" X="25" Y="70" Width="320" Height="40">
			  <Text>To install in this folder, click "Next". To install to a different folder, enter it below or click "Browse".</Text>
			</Control>
			<Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="374" Height="44" FixedSize="yes" Text="banner.bmp" />
			<Control Id="BannerLine" Type="Line" X="0" Y="44" Width="374" Height="0" />
			<Control Id="BottomLine" Type="Line" X="4" Y="234" Width="370" Height="0" />
			<Control Id="Description" Type="Text" X="25" Y="23" Width="280" Height="15" Transparent="yes" NoPrefix="yes">
			  <Text>This is the folder where [ProductName] will be installed.</Text>
			</Control>
			<Control Id="FolderLabel" Type="Text" X="20" Y="114" Width="348" Height="12" Text="&amp;Folder:" />
		  </Dialog>

		  <Dialog Id="CustomizeDialog" Width="370" Height="270" Title="[ProductName] [Setup]" NoMinimize="yes" TrackDiskSpace="yes">
			<Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="374" Height="44" FixedSize="yes" TabSkip="no" Text="banner.bmp" />
			<Control Id="Tree" Type="SelectionTree" X="25" Y="85" Width="175" Height="95" Property="_BrowseProperty" Sunken="yes" TabSkip="no" Text="Tree of selections" />
			<Control Id="Browse" Type="PushButton" X="304" Y="200" Width="56" Height="17" Text="[Button_Browse]">
			  <Publish Event="SelectionBrowse" Value="BrowseDialog"><![CDATA[1]]></Publish>
			  <Condition Action="hide"><![CDATA[Installed]]></Condition>
			</Control>
			<Control Id="Reset" Type="PushButton" X="42" Y="243" Width="56" Height="17" Text="[Button_Reset]">
			  <Publish Event="Reset" Value="0"><![CDATA[1]]></Publish>
			  <Subscribe Event="SelectionNoItems" Attribute="Enabled" />
			</Control>
			<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="[Button_Back]">
			  <Publish Event="NewDialog" Value="MaintenanceTypeDialog"><![CDATA[InstallMode = "Change"]]></Publish>
			  <Publish Event="NewDialog" Value="SetupTypeDlg"><![CDATA[InstallMode = "Custom"]]></Publish>
			</Control>
			<Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="[Button_Next]">
			  <Publish Event="NewDialog" Value="VerifyReadyDialog">1</Publish>
			  
			  <Publish Event="SetTargetPath" Value="TARGETDIR">1</Publish>
			  <Subscribe Event="SelectionNoItems" Attribute="Enabled" />
			</Control>
			<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="[Button_Cancel]">
			  <Publish Event="SpawnDialog" Value="CancelDialog"><![CDATA[1]]></Publish>
			</Control>
			<Control Id="Text" Type="Text" X="25" Y="55" Width="320" Height="20">
			  <Text>Click on the icons in the tree below to change the way features will be installed.</Text>
			</Control>
			<Control Id="BannerLine" Type="Line" X="0" Y="44" Width="374" Height="0" />
			<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="374" Height="0" />
			<Control Id="Box" Type="GroupBox" X="210" Y="81" Width="140" Height="98" />
			<Control Id="ItemDescription" Type="Text" X="215" Y="90" Width="131" Height="30">
			  <Text>Multiline description of the currently selected item.</Text>
			  <Subscribe Event="SelectionDescription" Attribute="Text" />
			</Control>
			<Control Id="ItemSize" Type="Text" X="215" Y="130" Width="131" Height="45">
			  <Text>The size of the currently selected item.</Text>
			  <Subscribe Event="SelectionSize" Attribute="Text" />
			</Control>
			<Control Id="Location" Type="Text" X="75" Y="200" Width="215" Height="20">
			  <Text>&lt;The selection's path&gt;</Text>
			  <Subscribe Event="SelectionPath" Attribute="Text" />
			  <Subscribe Event="SelectionPathOn" Attribute="Visible" />
			  <Condition Action="hide"><![CDATA[Installed]]></Condition>
			</Control>
			<Control Id="LocationLabel" Type="Text" X="25" Y="200" Width="50" Height="10" Text="Location:">
			  <Subscribe Event="SelectionPathOn" Attribute="Visible" />
			  <Condition Action="hide"><![CDATA[Installed]]></Condition>
			</Control>
		  </Dialog>

		  <Dialog Id="VerifyReadyDialog" Width="370" Height="270" Title="[ProductName]" NoMinimize="yes" TrackDiskSpace="yes">
			<Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="374" Height="44" FixedSize="yes" TabSkip="no" Text="banner.bmp" />
			<Control Id="Install" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="[Button_Install]">
			  <Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
			  <Publish Event="SpawnDialog" Value="OutOfRbDiskDlg"><![CDATA[OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)]]></Publish>
			  <Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"]]></Publish>
			  <Publish Event="EnableRollback" Value="False"><![CDATA[OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"]]></Publish>
			  <Publish Event="SpawnDialog" Value="OutOfDiskDlg"><![CDATA[(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")]]></Publish>
			</Control>
			<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="[Button_Cancel]">
			  <Publish Event="SpawnDialog" Value="CancelDialog"><![CDATA[1]]></Publish>
			</Control>
			<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="[Button_Back]">
			  <Publish Event="NewDialog" Value="CustomizeDialog"><![CDATA[InstallMode = "Custom" OR InstallMode = "Change"]]></Publish>
			  <Publish Event="NewDialog" Value="MaintenanceTypeDialog"><![CDATA[InstallMode = "Repair"]]></Publish>
			  <Publish Event="NewDialog" Value="SetupTypeDlg"><![CDATA[InstallMode = "Typical" OR InstallMode = "Complete"]]></Publish>
			</Control>
			<Control Id="InstallFolderText" Type="Text" X="25" Y="70" Width="320" Height="20">
			  <Text>Click Install to begin the installation to [INSTALLLOCATION].</Text>
			</Control>

			<Control Id="Text" Type="Text" X="25" Y="90" Width="320" Height="20">
			  <Text>If you want to review or change any of your installation settings, click Back.  Click Cancel to exit the wizard.</Text>
			</Control>

			<Control Id="BannerLine" Type="Line" X="0" Y="44" Width="374" Height="0" />
			<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="374" Height="0" />
		  </Dialog>
		  
		  <Dialog Id="VerifyRemoveDlg" Width="370" Height="270" Title="[ProductName] [Setup]" NoMinimize="yes" TrackDiskSpace="yes">
			<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Default="yes" Text="[Button_Back]">
			  <Publish Event="NewDialog" Value="MaintenanceTypeDialog"><![CDATA[1]]></Publish>
			</Control>
			<Control Id="Remove" Type="PushButton" X="236" Y="243" Width="56" Height="17" Text="[Button_Remove]">
			  <Publish Event="Remove" Value="All"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
			  <Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
			  <Publish Event="SpawnDialog" Value="OutOfRbDiskDlg"><![CDATA[OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)]]></Publish>
			  <Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"]]></Publish>
			  <Publish Event="EnableRollback" Value="False"><![CDATA[OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"]]></Publish>
			  <Publish Event="SpawnDialog" Value="OutOfDiskDlg"><![CDATA[(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")]]></Publish>
			</Control>
			<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="[Button_Cancel]">
			  <Publish Event="SpawnDialog" Value="CancelDialog"><![CDATA[1]]></Publish>
			</Control>
			<Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="374" Height="44" TabSkip="no" Text="banner.bmp" />
			<Control Id="Text" Type="Text" X="25" Y="70" Width="320" Height="30">
			  <Text>Click Remove to remove [ProductName] from your computer.  If you want to review or change any of your installation settings, click Back.  Click Cancel to exit the wizard.</Text>
			</Control>
			<Control Id="BannerLine" Type="Line" X="0" Y="44" Width="374" Height="0" />
			<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="374" Height="0" />
		  </Dialog>

		  <Dialog Id="VerifyRepairDlg" Width="370" Height="270" Title="[ProductName] [Setup]" NoMinimize="yes" TrackDiskSpace="yes">
			<Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="374" Height="44" FixedSize="yes" TabSkip="no" Text="banner.bmp" />
			<Control Id="Repair" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="[Button_Repair]">
			  <Publish Event="ReinstallMode" Value="ecmus"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
			  <Publish Event="Reinstall" Value="All"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
			  <Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
			  <Publish Event="SpawnDialog" Value="OutOfRbDiskDlg"><![CDATA[OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)]]></Publish>
			  <Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"]]></Publish>
			  <Publish Event="EnableRollback" Value="False"><![CDATA[OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"]]></Publish>
			  <Publish Event="SpawnDialog" Value="OutOfDiskDlg"><![CDATA[(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")]]></Publish>
			</Control>
			<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="[Button_Cancel]">
			  <Publish Event="SpawnDialog" Value="CancelDialog"><![CDATA[1]]></Publish>
			</Control>
			<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="[Button_Back]">
			  <Publish Event="NewDialog" Value="MaintenanceTypeDialog"><![CDATA[1]]></Publish>
			</Control>
			<Control Id="Text" Type="Text" X="25" Y="70" Width="320" Height="30">
			  <Text>Click Repair to repair the installation of [ProductName].  If you want to review or change any of your installation settings, click Back.  Click Cancel to exit the wizard.</Text>
			</Control>
			<Control Id="BannerLine" Type="Line" X="0" Y="44" Width="374" Height="0" />
			<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="374" Height="0" />
		  </Dialog>
		  
		  <Dialog Id="ProgressDialog" Width="370" Height="270" Title="[ProductName]" Modeless="yes">
			<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Default="yes" Cancel="yes" Text="[Button_Cancel]">
			  <Publish Event="SpawnDialog" Value="CancelDialog">1</Publish>
			</Control>
			<Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="374" Height="44" FixedSize="yes" TabSkip="no" Text="banner.bmp" />
			<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Disabled="yes" Text="[Button_Back]" />
			<Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Disabled="yes" Text="[Button_Next]" />
			<Control Id="Text" Type="Text" X="35" Y="65" Width="300" Height="20">
			  <Text>Please wait while [ProductName] is installed.</Text>
			</Control>
			<Control Id="BannerLine" Type="Line" X="0" Y="44" Width="374" Height="0" />
			<Control Id="BottomLine" Type="Line" X="4" Y="234" Width="370" Height="0" />
			<Control Id="ActionText" Type="Text" X="70" Y="100" Width="265" Height="10">
			  <Subscribe Event="ActionText" Attribute="Text" />
			</Control>
			<Control Id="ProgressBar" Type="ProgressBar" X="35" Y="115" Width="300" Height="10" ProgressBlocks="yes" Text="Progress done">
			  <Subscribe Event="SetProgress" Attribute="Progress" />
			</Control>
			<Control Id="StatusLabel" Type="Text" X="35" Y="100" Width="35" Height="10" Text="Status:" />
		  </Dialog>

		  <Dialog Id="SetupTypeDlg" Width="370" Height="270" Title="[ProductName] [Setup]" NoMinimize="yes">
			<Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="374" Height="44" FixedSize="yes" TabSkip="no" Text="banner.bmp" />
			
			<Control Id="CustomLabel" Type="Text" X="105" Y="65" Width="100" Height="10" TabSkip="no">
			  <Text>[DlgTitleFont]C&amp;ustom</Text>
			</Control>
			<Control Id="CustomButton" Type="PushButton" X="50" Y="65" Width="38" Height="38" ToolTip="Custom Installation" Icon="yes" FixedSize="yes" IconSize="32" Text="[CustomSetupIcon]">
			  <Publish Property="InstallMode" Value="Custom"><![CDATA[1]]></Publish>
			  <Publish Event="NewDialog" Value="CustomizeDialog"><![CDATA[1]]></Publish>
			</Control>
			<Control Id="CompleteLabel" Type="Text" X="105" Y="118" Width="100" Height="10" TabSkip="no">
			  <Text>[DlgTitleFont]C&amp;omplete</Text>
			</Control>
			<Control Id="CompleteButton" Type="PushButton" X="50" Y="118" Width="38" Height="38" ToolTip="Complete Installation" Icon="yes" FixedSize="yes" IconSize="32" Text="[CompleteSetupIcon]">
			  <Publish Property="InstallMode" Value="Complete"><![CDATA[1]]></Publish>
			  <Publish Event="SetInstallLevel" Value="1000"><![CDATA[1]]></Publish>
			  <Publish Event="NewDialog" Value="VerifyReadyDialog"><![CDATA[1]]></Publish>
			</Control>
			<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="[Button_Back]">
			  <Publish Event="NewDialog" Value="WelcomeDialog">
			  </Publish>
			</Control>
			<Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Disabled="yes" Text="[Button_Next]" />
			<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="[Button_Cancel]">
			  <Publish Event="SpawnDialog" Value="CancelDialog"><![CDATA[1]]></Publish>
			</Control>
			<Control Id="BannerLine" Type="Line" X="0" Y="44" Width="374" Height="0" />
			<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="374" Height="0" />
			<Control Id="CustomText" Type="Text" X="105" Y="78" Width="230" Height="30">
			  <Text>Allows users to choose which program features will be installed and where they will be installed. Recommended for advanced users.</Text>
			</Control>
			<Control Id="CompleteText" Type="Text" X="105" Y="131" Width="230" Height="20">
			  <Text>All program features will be installed.  (Requires most disk space)</Text>
			</Control>
		  </Dialog>

		  <Dialog Id="MaintenanceTypeDialog" Width="370" Height="270" Title="[ProductName] [Setup]" NoMinimize="yes">
			<Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="374" Height="44" FixedSize="yes" TabSkip="no" Text="banner.bmp" />
			<Control Id="ChangeLabel" Type="Text" X="105" Y="65" Width="100" Height="10" TabSkip="no">
			  <Text>[DlgTitleFont]&amp;Modify</Text>
			</Control>
			<Control Id="ChangeButton" Type="PushButton" X="50" Y="65" Width="38" Height="38" ToolTip="Modify Installation" Default="yes" Icon="yes" FixedSize="yes" IconSize="32" Text="[CustomSetupIcon]">
			  <Publish Property="InstallMode" Value="Change"><![CDATA[1]]></Publish>
			  <Publish Property="Progress1" Value="Changing"><![CDATA[1]]></Publish>
			  <Publish Property="Progress2" Value="changes"><![CDATA[1]]></Publish>
			  <Publish Event="NewDialog" Value="CustomizeDialog"><![CDATA[1]]></Publish>
			</Control>
			<Control Id="RepairLabel" Type="Text" X="105" Y="114" Width="100" Height="10" TabSkip="no">
			  <Text>[DlgTitleFont]Re&amp;pair</Text>
			</Control>
			<Control Id="RepairButton" Type="PushButton" X="50" Y="114" Width="38" Height="38" ToolTip="Repair Installation" Icon="yes" FixedSize="yes" IconSize="32" Text="[RepairIcon]">
			  <Publish Property="InstallMode" Value="Repair"><![CDATA[1]]></Publish>
			  <Publish Property="Progress1" Value="Repairing"><![CDATA[1]]></Publish>
			  <Publish Property="Progress2" Value="repaires"><![CDATA[1]]></Publish>
			  <Publish Event="NewDialog" Value="VerifyRepairDlg"><![CDATA[1]]></Publish>
			</Control>
			<Control Id="RemoveLabel" Type="Text" X="105" Y="163" Width="100" Height="10" TabSkip="no">
			  <Text>[DlgTitleFont]&amp;Remove</Text>
			</Control>
			<Control Id="RemoveButton" Type="PushButton" X="50" Y="163" Width="38" Height="38" ToolTip="Remove Installation" Icon="yes" FixedSize="yes" IconSize="32" Text="[RemoveIcon]">
			  <Publish Property="InstallMode" Value="Remove"><![CDATA[1]]></Publish>
			  <Publish Property="Progress1" Value="Removing"><![CDATA[1]]></Publish>
			  <Publish Property="Progress2" Value="removes"><![CDATA[1]]></Publish>
			  <Publish Event="NewDialog" Value="VerifyRemoveDlg"><![CDATA[1]]></Publish>
			</Control>
			<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="[Button_Back]">
			  <Publish Event="NewDialog" Value="MaintenanceWelcomeDialog"><![CDATA[1]]></Publish>
			</Control>
			<Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Disabled="yes" Text="[Button_Next]" />
			<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="[Button_Cancel]">
			  <Publish Event="SpawnDialog" Value="CancelDialog"><![CDATA[1]]></Publish>
			</Control>
			<Control Id="BannerLine" Type="Line" X="0" Y="44" Width="374" Height="0" />
			<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="374" Height="0" />
			<Control Id="ChangeText" Type="Text" X="105" Y="78" Width="230" Height="20">
			  <Text>Allows users to change the way features are installed.</Text>
			</Control>
			<Control Id="RemoveText" Type="Text" X="105" Y="176" Width="230" Height="20">
			  <Text>Removes [ProductName] from your computer.</Text>
			</Control>
			<Control Id="RepairText" Type="Text" X="105" Y="127" Width="230" Height="30">
			  <Text>Repairs errors in the most recent installation state - fixes missing or corrupt files, shortcuts and registry entries.</Text>
			</Control>
		  </Dialog>

		  <Dialog Id="CancelDialog" Width="260" Height="85" Title="[ProductName] [Setup]" NoMinimize="yes">
			<Control Id="Text" Type="Text" X="48" Y="15" Width="194" Height="30">
			  <Text>Are you sure you want to cancel [ProductName] installation?</Text>
			</Control>
			<Control Id="Yes" Type="PushButton" X="72" Y="57" Width="56" Height="17" Text="[Button_Yes]">
			  <Publish Event="EndDialog" Value="Exit">1</Publish>
			</Control>
			<Control Id="No" Type="PushButton" X="132" Y="57" Width="56" Height="17" Default="yes" Cancel="yes" Text="[Button_No]">
			  <Publish Event="EndDialog" Value="Return">1</Publish>
			</Control>
			<Control Id="Icon" Type="Icon" X="15" Y="15" Width="24" Height="24" FixedSize="yes" IconSize="32" Text="info.bmp" />
		  </Dialog>

		  <Dialog Id="BrowseDialog" Width="370" Height="270" Title="[ProductName] [Setup]" NoMinimize="yes">
			<Control Id="PathEdit" Type="PathEdit" X="84" Y="202" Width="261" Height="18" Property="_BrowseProperty" Indirect="yes" />
			<Control Id="OK" Type="PushButton" X="304" Y="243" Width="56" Height="17" Default="yes" Text="[Button_OK]">
			  <Publish Event="SetTargetPath" Value="[_BrowseProperty]"><![CDATA[1]]></Publish>
			  <Publish Event="EndDialog" Value="Return">1</Publish>
			</Control>
			<Control Id="Cancel" Type="PushButton" X="240" Y="243" Width="56" Height="17" Cancel="yes" Text="[Button_Cancel]">
			  <Publish Event="Reset" Value="0">1</Publish>
			  <Publish Event="EndDialog" Value="Return">1</Publish>
			</Control>
			<Control Id="ComboLabel" Type="Text" X="25" Y="58" Width="44" Height="10" TabSkip="no" Text="&amp;Look in:" />
			<Control Id="DirectoryCombo" Type="DirectoryCombo" X="70" Y="55" Width="220" Height="80" Property="_BrowseProperty" Indirect="yes" Fixed="yes" Remote="yes">
			  <Subscribe Event="IgnoreChange" Attribute="IgnoreChange" />
			</Control>
			<Control Id="Up" Type="PushButton" X="298" Y="55" Width="19" Height="19" Icon="yes" FixedSize="yes" IconSize="16" Text="up.bmp">
			  <Publish Event="DirectoryListUp" Value="0">1</Publish>
			</Control>
			<Control Id="NewFolder" Type="PushButton" X="325" Y="55" Width="19" Height="19" Icon="yes" FixedSize="yes" IconSize="16" Text="new.bmp">
			  <Publish Event="DirectoryListNew" Value="0">1</Publish>
			</Control>
			<Control Id="DirectoryList" Type="DirectoryList" X="25" Y="83" Width="320" Height="110" Property="_BrowseProperty" Sunken="yes" Indirect="yes" TabSkip="no" />
			<Control Id="PathLabel" Type="Text" X="25" Y="205" Width="59" Height="10" TabSkip="no" Text="&amp;Folder name:" />
			<Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="374" Height="44" FixedSize="yes" TabSkip="no" Text="banner.bmp" />
			<Control Id="BannerLine" Type="Line" X="0" Y="44" Width="374" Height="0" />
			<Control Id="BottomLine" Type="Line" X="4" Y="234" Width="370" Height="0" />
		  </Dialog>

		  <Dialog Id="UserExit" Width="370" Height="270" Title="[ProductName] [Setup]">
			<Control Id="Finish" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Cancel="yes" Text="[Button_Finish]">
			  <Publish Event="EndDialog" Value="Exit">1</Publish>
			</Control>
			<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Disabled="yes" Text="[Button_Cancel]" />
			<Control Id="Bitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="234" FixedSize="yes" TabSkip="no" Text="dialog.bmp" />
			<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Disabled="yes" Text="[Button_Back]" />
			<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="374" Height="0" />
			<Control Id="Title" Type="Text" X="135" Y="20" Width="220" Height="60" Transparent="yes" NoPrefix="yes">
			  <Text>[BigFont][ProductName] installation was interrupted</Text>
			</Control>
			<Control Id="Description1" Type="Text" X="135" Y="70" Width="220" Height="40" Transparent="yes" NoPrefix="yes">
			  <Text>The installation was interrupted before [ProductName] could be installed. You need to restart the installer to try again.</Text>
			</Control>
			<Control Id="Description2" Type="Text" X="135" Y="215" Width="220" Height="20" Transparent="yes" NoPrefix="yes">
			  <Text>Click the Finish button to exit.</Text>
			</Control>
		  </Dialog>

		  <Dialog Id="ExitDialog" Width="370" Height="270" Title="[ProductName]" NoMinimize="yes">
			<Control Id="Finish" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Cancel="yes" Text="[Button_Finish]">
			  <Publish Event="EndDialog" Value="Return"></Publish>
			</Control>
			<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Disabled="yes" Text="[Button_Cancel]" />
			<Control Id="Bitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="234" FixedSize="yes" TabSkip="no" Text="dialog.bmp" />
			<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Disabled="yes" Text="[Button_Back]" />
			<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="374" Height="0" />
			<Control Id="DescriptionLine1" Type="Text" X="135" Y="70" Width="220" Height="20" Transparent="yes" NoPrefix="yes">
			  <Text>[ProductName] successfully installed in [TARGETDIR]</Text>
			</Control>
			<Control Id="DescriptionLine2" Type="Text" X="135" Y="90" Width="220" Height="20" Transparent="yes" NoPrefix="yes">
			  <Text>Click the Finish button to exit.</Text>
			</Control>
			<Control Id="Title" Type="Text" X="135" Y="20" Width="220" Height="60" Transparent="yes" NoPrefix="yes">
			  <Text>[BigFont]Completing the [ProductName] installation.</Text>
			</Control>
		  </Dialog>

		  <Dialog Id="OutOfDiskDlg" Width="370" Height="270" Title="[ProductName] [Setup]" NoMinimize="yes">
			<Control Id="OK" Type="PushButton" X="304" Y="243" Width="56" Height="17" Default="yes" Cancel="yes" Text="[Button_OK]">
			  <Publish Event="EndDialog" Value="Return">1</Publish>
			</Control>
			<Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="374" Height="44" FixedSize="yes" TabSkip="no" Text="banner.bmp" />
			<Control Id="Text" Type="Text" X="20" Y="53" Width="330" Height="40">
			  <Text>The highlighted volumes do not have enough disk space available for the currently selected features.  You can either remove some files from the highlighted volumes, or choose to install less features onto local drive(s), or select different destination drive(s).</Text>
			</Control>
			<Control Id="BannerLine" Type="Line" X="0" Y="44" Width="374" Height="0" />
			<Control Id="BottomLine" Type="Line" X="4" Y="234" Width="370" Height="0" />
			<Control Id="VolumeList" Type="VolumeCostList" X="20" Y="100" Width="330" Height="120" Sunken="yes" Fixed="yes" Remote="yes">
			  <Text>{120}{70}{70}{70}{70}</Text>
			</Control>
		  </Dialog>
		  
		  <Dialog Id="OutOfRbDiskDlg" Width="370" Height="270" Title="[ProductName] [Setup]" NoMinimize="yes">
			<Control Id="No" Type="PushButton" X="304" Y="243" Width="56" Height="17" Default="yes" Cancel="yes" Text="[Button_No]">
			  <Publish Event="EndDialog" Value="Return">1</Publish>
			</Control>
			<Control Id="Yes" Type="PushButton" X="240" Y="243" Width="56" Height="17" Text="[Button_Yes]">
			  <Publish Event="EnableRollback" Value="False">1</Publish>
			  <Publish Event="EndDialog" Value="Return">1</Publish>
			</Control>
			<Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="374" Height="44" FixedSize="yes" TabSkip="no" Text="banner.bmp" />
			<Control Id="Text" Type="Text" X="20" Y="53" Width="330" Height="40">
			  <Text>The highlighted volumes do not have enough disk space available for the currently selected features.  You can either remove some files from the highlighted volumes, or choose to install less features onto local drive(s), or select different destination drive(s).</Text>
			</Control>
			<Control Id="BannerLine" Type="Line" X="0" Y="44" Width="374" Height="0" />
			<Control Id="BottomLine" Type="Line" X="4" Y="234" Width="370" Height="0" />
			<Control Id="VolumeList" Type="VolumeCostList" X="20" Y="140" Width="330" Height="80" Sunken="yes" Fixed="yes" Remote="yes" ShowRollbackCost="yes">
			  <Text>{120}{70}{70}{70}{70}</Text>
			</Control>
			<Control Id="Text2" Type="Text" X="20" Y="94" Width="330" Height="40">
			  <Text>Alternatively, you may choose to disable the installer's rollback functionality.  This allows the installer to restore your computer's original state should the installation be interrupted in any way.  Click Yes if you wish to take the risk to disable rollback.</Text>
			</Control>
		  </Dialog>
		  
		  <Dialog Id="FatalError" Width="370" Height="270" Title="[ProductName]" NoMinimize="yes">
			<Control Id="Finish" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Cancel="yes" Text="[Button_Finish]">
			  <Publish Event="EndDialog" Value="Exit">1</Publish>
			</Control>
			<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Disabled="yes" Text="[Button_Cancel]" />
			<Control Id="Bitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="234" FixedSize="yes" TabSkip="no" Text="dialog.bmp" />
			<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Disabled="yes" Text="[Button_Back]" />
			<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="374" Height="0" />
			<Control Id="Description1" Type="Text" X="135" Y="70" Width="220" Height="40" Transparent="yes" NoPrefix="yes">
			  <Text>[ProductName] setup ended prematurely because of an error.  Your system has not been modified.  To install this program at a later time, please run the installation again.</Text>
			</Control>
			<Control Id="Description2" Type="Text" X="135" Y="115" Width="220" Height="20" Transparent="yes" NoPrefix="yes">
			  <Text>Click the Finish button to exit the.</Text>
			</Control>
		  </Dialog>
		  <!-- END DIALOG DEFINITION -->
		</UI>
		
		<Binary Id="completi" SourceFile="$(env.resources.dir)/completi.ico" />
		<Binary Id="custicon" SourceFile="$(env.resources.dir)/custicon.ico" />
		<Binary Id="insticon" SourceFile="$(env.resources.dir)/insticon.ico" />
		<Binary Id="repairic" SourceFile="$(env.resources.dir)/repairic.ico" />
		<Binary Id="removico" SourceFile="$(env.resources.dir)/removico.ico" />
		<Binary Id="dialog.bmp" SourceFile="$(env.resources.dir)/default-dialog.bmp" />
		<Binary Id="banner.bmp" SourceFile="$(env.resources.dir)/default-banner.bmp" />
		<Binary Id="info.bmp" SourceFile="$(env.resources.dir)/info.bmp" />
		<Binary Id="up.bmp" SourceFile="$(env.resources.dir)/up.bmp" />
		<Binary Id="new.bmp" SourceFile="$(env.resources.dir)/new.bmp" />

		<!-- Post Installer action -->		
		<CustomAction 	Id="OMNPostInstallerCustomAction.Install.id" 
						FileKey="OMNPostInstaller.id" 
						ExeCommand='install @target.vs-year.version@ "[INSTALLLOCATION]OMAddin.dll"'
						Impersonate="no"
						Execute="deferred"
						Return="check" />
						
		<CustomAction 
						Id="OMNPostInstallerCustomAction.UnInstall.id" 
						FileKey="OMNPostInstaller.id" 
						ExeCommand='uninstall @target.vs-year.version@'
						Impersonate="no"
						Execute="deferred"
						Return="check" />
						
		<CustomAction 	Id="InitializeTargetDir" 
						Property="TARGETDIR" 
						Value="[INSTALLLOCATION]" 
						Execute="firstSequence" />
						
		<CustomAction 	Id="UpdateTargetDir" 
						Property="TARGETDIR" 
						Value="[INSTALLLOCATION]" 
						Execute="firstSequence" />
		
		<InstallExecuteSequence>
			<FindRelatedProducts />
			<Custom Action='OMNPostInstallerCustomAction.Install.id' After="PublishProduct">NOT Installed</Custom>
			<Custom Action='OMNPostInstallerCustomAction.UnInstall.id' Before='RemoveFiles'>Installed AND NOT UPGRADINGPRODUCTCODE</Custom>
		</InstallExecuteSequence>
	</Product>
</Wix>
